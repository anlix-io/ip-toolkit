var L=Object.defineProperty;var C=(r,t)=>{for(var n in t)L(r,n,{get:t[n],enumerable:!0})};var E=(r,t,n)=>{if(!t.has(r))throw TypeError("Cannot "+n)};var m=(r,t,n)=>(E(r,t,"read from private field"),n?n.call(r):t.get(r)),R=(r,t,n)=>{if(t.has(r))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(r):t.set(r,n)},M=(r,t,n,e)=>(E(r,t,"write to private field"),e?e.call(r,n):t.set(r,n),n);var X={};C(X,{contains:()=>V,ip2long:()=>s,ipRange:()=>I,isCIDR:()=>N,isConflict:()=>B,isEqual:()=>D,isPrivate:()=>$,isSameSubnet:()=>G,isValidIP:()=>f,isValidMask:()=>u,long2ip:()=>a,parseCIDR:()=>b,parseSubnet:()=>_,toBinHex:()=>q,toIPv6Format:()=>O,toInverseMask:()=>Q,toMaskLength:()=>k,toSubnetMask:()=>h});function s(r){if(!f(r))return!1;let t=0,n=r.split(".");for(let e of n)t=(t<<8)+ +e;return t>>>0}function a(r){if(typeof r!="number")return!1;if(r>=0&&r<=4294967295){let t=[];for(let n=3;n>=0;n--)t.push(r>>>n*8&255);return t.join(".")}else return!1}var d,x,S=class S{constructor(t,n){R(this,d,void 0);R(this,x,void 0);if(+t<0||+t>4294967295||+n<0||+n>4294967295)throw new Error("Invalid start or end IPv4 address");M(this,d,t),M(this,x,n)}static fromLong(t,n){if(typeof t!="number"||typeof n!="number")throw new Error("Invalid start or end IPv4 address");if(+n<+t)throw new Error("Invalid range value, end must be greater than or equal to start");return new S(t,n)}static fromString(t,n){let e=s(t),o=s(n);if(typeof e!="number"||typeof o!="number")throw new Error("Invalid start or end IPv4 address");if(o<e)throw new Error("Invalid range value, end must be greater than or equal to start");return new S(e,o)}ip2long(){return[m(this,d),m(this,x)]}long2ip(){return[a(m(this,d)),a(m(this,x))]}ipCount(){return m(this,x)-m(this,d)+1}contains(t){let n=s(t);return typeof n!="number"?!1:n>=m(this,d)&&n<=m(this,x)}};d=new WeakMap,x=new WeakMap;var I=S;function N(r){return typeof r!="string"?!1:typeof b(r)=="object"}function D(r,t){return typeof r=="number"&&(r<0||r>4294967295)||typeof t=="number"&&(t<0||t>4294967295)||(typeof r=="string"&&(r=s(r)),typeof t=="string"&&(t=s(t)),typeof r!="number"||typeof t!="number")?!1:r===t}function V(r,t){let n=b(r);if(typeof n!="object"||!f(t))return!1;let{cidrMask:e,firstHost:o,lastHost:i,networkAddress:p,broadcastAddress:c}=n;return e>=31?I.fromString(o,i).contains(t):I.fromString(p,c).contains(t)}function f(r,t={strict:!1}){return t.strict?/^(1\d{2}|2[0-4]\d|25[0-5]|[1-9]\d|[1-9])(\.(1\d{2}|2[0-4]\d|25[0-5]|[1-9]\d|\d)){3}$/.test(r):/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)(\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/.test(r)}function $(r){if(!f(r))return!1;let t=[{start:"10.0.0.0",end:"10.255.255.255"},{start:"127.0.0.0",end:"127.255.255.255"},{start:"172.16.0.0",end:"172.31.255.255"},{start:"169.254.0.0",end:"169.254.255.255"},{start:"192.168.0.0",end:"192.168.255.255"}];for(let n of t)if(I.fromString(n.start,n.end).contains(r))return!0;return!1}function b(r){if(typeof r!="string")return!1;let[t,n]=r.split("/");if(t===void 0||n===void 0||n===""||!f(t,{strict:!0})||!u(+n))return!1;let e=32-+n,o=s(t),i=Number(0b1n<<BigInt(e)),p=+n?o>>e<<e>>>0:0,c=(p|i-1)>>>0;return{ipCount:i,cidrMask:+n,usableCount:+n<31?i-2:i,subnetMask:h(+n),networkAddress:+n<31?a(p):"",broadcastAddress:+n<31?a(c):"",firstHost:a(p+(+n<31?1:0)),lastHost:a(c-(+n<31?1:0))}}function B(r){if(!Array.isArray(r)||r.length===0)return!1;let t=[];for(let n of r){let e=b(n);typeof e=="object"&&t.push({cidr:n,networkAddress:e.networkAddress||e.firstHost})}for(let n=0;n<t.length;n++)for(let e=n+1;e<t.length;e++){let o=V(t[e].cidr,t[n].networkAddress),i=V(t[n].cidr,t[e].networkAddress);if(o||i)return!0}return!1}function _(r,t){if(!f(r)||!u(t))return!1;let n=k(t);return b(`${r}/${n}`)}function u(r){if(typeof r=="number"&&!isNaN(r))return!(r<0||r>32);if(typeof r=="string"){let t=s(r);return typeof t!="number"?!1:/^1*0*$/.test(t.toString(2).padStart(32,"0"))}else return!1}function G(r,t,n){if(!f(r)||!f(t)||!u(n))return!1;let e=s(r),o=s(t);typeof n=="number"&&(n=h(n));let i=s(n);return(e&i)===(o&i)}function q(r){if(!f(r))return!1;let t=s(r);return{decimal:t,hex:`0x${t.toString(16).padStart(8,"0")}`,binary:t.toString(2).padStart(32,"0")}}var v={};C(v,{compressedForm:()=>P,contains:()=>H,expandedForm:()=>y,ip2long:()=>l,isCIDR:()=>z,isConflict:()=>K,isEqual:()=>J,isValidIP:()=>g,long2ip:()=>F,parseCIDR:()=>A});function l(r){if(!g(r))return!1;let t=[];r=y(r);let n=r.split(":");for(let e=0;e<n.length;e++){let o=parseInt(n[e],16);t.push(o.toString(2).padStart(16,"0"))}return BigInt(`0b${t.join("")}`)}function P(r){if(!g(r))return!1;if(l(r)===0n)return"::";r=y(r);let n=r.split(":").map(o=>{let i=parseInt(o,16);return i?i.toString(16):"X"}).join(":"),e=[/(X:X:X:X:X:X:X)/,/(X:X:X:X:X:X)/,/(X:X:X:X:X)/,/(X:X:X:X)/,/(X:X:X)/,/(X:X)/];for(let o=0;o<e.length;o++)if(n.match(e[o]))return n.replace(e[o],":").replace(":::","::").replaceAll("X","0");return n.replaceAll("X","0")}function F(r){if(typeof r!="bigint")return!1;if(r>=0n&&r<=340282366920938463463374607431768211455n){let t=[],n=r.toString(16).padStart(32,"0");for(let e=0;e<8;e++)t.push(n.slice(e*4,(e+1)*4));return P(t.join(":"))}else return!1}function H(r,t){let n=A(r);if(typeof n!="object"||!g(t))return!1;let{lastHost:e,firstHost:o}=n,i=l(t),p=l(e),c=l(o);return i>=c&&i<=p}function z(r){return typeof r!="string"?!1:typeof A(r)=="object"}function J(r,t){return typeof r=="bigint"&&(r<0n||r>340282366920938463463374607431768211455n)||typeof t=="bigint"&&(t<0||t>340282366920938463463374607431768211455n)||(typeof r=="string"&&(r=l(r)),typeof t=="string"&&(t=l(t)),typeof r!="bigint"||typeof t!="bigint")?!1:r===t}function g(r){return/^[\s]*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)(\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)(\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)(\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)(\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)(\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)(\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)(\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}))|:)))(%.+)?[\s]*$/.test(r)}function K(r){if(!Array.isArray(r)||r.length===0)return!1;let t=[];for(let n of r){let e=A(n);typeof e=="object"&&t.push({cidr:n,firstHost:e.firstHost})}for(let n=0;n<t.length;n++)for(let e=n+1;e<t.length;e++){let o=H(t[e].cidr,t[n].firstHost),i=H(t[n].cidr,t[e].firstHost);if(o||i)return!0}return!1}function A(r){if(typeof r!="string")return!1;let[t,n]=r.split("/");if(t===void 0||n===void 0||n==="")return!1;let e=+n;if(!g(t)||isNaN(e)||e<0||e>128)return!1;let o=BigInt(128-e),i=l(t),p=BigInt(0b1n<<o),c=i>>o<<o,w=F(c),j=F(c|p-1n);return{ipCount:p,firstHost:w,lastHost:j,prefixLength:e}}function y(r){if(!g(r))return!1;if(r==="::")return"0000:".repeat(8).slice(0,-1);let t=r.split(":");for(let e=0;e<t.length;e++)t[e]===""&&t[e+1]===""&&t.splice(e,1);let n=t[t.length-1];if(X.isValidIP(n)){let e=X.toBinHex(n).hex.slice(2);t.pop()&&t.push(e.slice(0,4),e.slice(4))}return t.map(e=>e?e.padStart(4,"0"):"0000:".repeat(9-t.length).slice(0,-1)).join(":")}function O(r){if(!f(r))return!1;let t=s(r),n=a(t);return{mapped:`::ffff:${n}`,comperssed:P(`::ffff:${n}`),expanded:y(`::ffff:${n}`)}}function h(r){if(typeof r!="number"||isNaN(r)||!u(r))return!1;let t=4294967295<<32-r;return r?a(t>>>0):"0.0.0.0"}function k(r){if(typeof r!="string"||!u(r))return!1;let t=s(r);return t===0?0:t.toString(2).replaceAll("0","").length}function Q(r){if(!u(r))return!1;typeof r=="number"&&(r=h(r));let n=~s(r)>>>0;return a(n)}export{X as IPv4,v as IPv6};
