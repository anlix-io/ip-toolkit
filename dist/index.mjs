var N=Object.defineProperty;var E=(t,r)=>{for(var n in r)N(t,n,{get:r[n],enumerable:!0})};var C=(t,r,n)=>{if(!r.has(t))throw TypeError("Cannot "+n)};var l=(t,r,n)=>(C(t,r,"read from private field"),n?n.call(t):r.get(t)),V=(t,r,n)=>{if(r.has(t))throw TypeError("Cannot add the same private member more than once");r instanceof WeakSet?r.add(t):r.set(t,n)},M=(t,r,n,e)=>(C(t,r,"write to private field"),e?e.call(t,n):r.set(t,n),n);var P={};E(P,{contains:()=>S,ip2long:()=>o,ipRange:()=>d,isCIDR:()=>$,isConflict:()=>L,isEqual:()=>j,isPrivate:()=>B,isSameSubnet:()=>G,isValidIP:()=>i,isValidMask:()=>u,long2ip:()=>a,parseCIDR:()=>g,parseSubnet:()=>D,toBinHex:()=>_,toIPv6Format:()=>J,toInverseMask:()=>K,toMaskLength:()=>k,toSubnetMask:()=>h});function o(t){if(!i(t))return!1;let r=0,n=t.split(".");for(let e of n)r=(r<<8)+ +e;return r>>>0}function a(t){if(typeof t!="number")return!1;if(t>=0&&t<=4294967295){let r=[];for(let n=3;n>=0;n--)r.push(t>>>n*8&255);return r.join(".")}else return!1}var m,b,X=class X{constructor(r,n){V(this,m,void 0);V(this,b,void 0);if(+r<0||+r>4294967295||+n<0||+n>4294967295)throw new Error("Invalid start or end IPv4 address");M(this,m,r),M(this,b,n)}static fromLong(r,n){if(typeof r!="number"||typeof n!="number")throw new Error("Invalid start or end IPv4 address");if(+n<+r)throw new Error("Invalid range value, end must be greater than or equal to start");return new X(r,n)}static fromString(r,n){let e=o(r),s=o(n);if(typeof e!="number"||typeof s!="number")throw new Error("Invalid start or end IPv4 address");if(s<e)throw new Error("Invalid range value, end must be greater than or equal to start");return new X(e,s)}ip2long(){return[l(this,m),l(this,b)]}long2ip(){return[a(l(this,m)),a(l(this,b))]}ipCount(){return l(this,b)-l(this,m)+1}contains(r){let n=o(r);return typeof n!="number"?!1:n>=l(this,m)&&n<=l(this,b)}};m=new WeakMap,b=new WeakMap;var d=X;function $(t){return typeof t!="string"?!1:typeof g(t)=="object"}function j(t,r){return typeof t=="number"&&(t<0||t>4294967295)||typeof r=="number"&&(r<0||r>4294967295)||(typeof t=="string"&&(t=o(t)),typeof r=="string"&&(r=o(r)),typeof t!="number"||typeof r!="number")?!1:t===r}function S(t,r){let n=g(t);if(typeof n!="object"||!i(r))return!1;let{cidrMask:e,firstHost:s,lastHost:f,networkAddress:c,broadcastAddress:I}=n;return e>=31?d.fromString(s,f).contains(r):d.fromString(c,I).contains(r)}function i(t,r={strict:!1}){return r.strict?/^(1\d{2}|2[0-4]\d|25[0-5]|[1-9]\d|[1-9])(\.(1\d{2}|2[0-4]\d|25[0-5]|[1-9]\d|\d)){3}$/.test(t):/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)(\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/.test(t)}function B(t){if(!i(t))return!1;let r=[{start:"10.0.0.0",end:"10.255.255.255"},{start:"127.0.0.0",end:"127.255.255.255"},{start:"172.16.0.0",end:"172.31.255.255"},{start:"169.254.0.0",end:"169.254.255.255"},{start:"192.168.0.0",end:"192.168.255.255"}];for(let n of r)if(d.fromString(n.start,n.end).contains(t))return!0;return!1}function g(t){if(typeof t!="string")return!1;let[r,n]=t.split("/");if(!i(r,{strict:!0})||!u(+n))return!1;let e=32-+n,s=o(r),f=Number(0b1n<<BigInt(e)),c=+n?s>>e<<e>>>0:0,I=(c|f-1)>>>0;return{ipCount:f,cidrMask:+n,usableCount:+n<31?f-2:f,subnetMask:h(+n),networkAddress:+n<31?a(c):"",broadcastAddress:+n<31?a(I):"",firstHost:a(c+(+n<31?1:0)),lastHost:a(I-(+n<31?1:0))}}function L(t){if(!Array.isArray(t)||t.length===0)return!1;let r=[];for(let n of t){let e=g(n);typeof e=="object"&&r.push({cidr:n,networkAddress:e.networkAddress||e.firstHost})}for(let n=0;n<r.length;n++)for(let e=n+1;e<r.length;e++){let s=S(r[e].cidr,r[n].networkAddress),f=S(r[n].cidr,r[e].networkAddress);if(s||f)return!0}return!1}function D(t,r){if(!i(t)||!u(r))return!1;let n=k(r);return g(`${t}/${n}`)}function u(t){if(typeof t=="number"&&!isNaN(t))return!(t<0||t>32);if(typeof t=="string"){let r=o(t);return typeof r!="number"?!1:/^1*0*$/.test(r.toString(2).padStart(32,"0"))}else return!1}function G(t,r,n){if(!i(t)||!i(r)||!u(n))return!1;let e=o(t),s=o(r);typeof n=="number"&&(n=h(n));let f=o(n);return(e&f)===(s&f)}function _(t){if(!i(t))return!1;let r=o(t);return{decimal:r,hex:`0x${r.toString(16).padStart(8,"0")}`,binary:r.toString(2).padStart(32,"0")}}var H={};E(H,{compressedForm:()=>A,expandedForm:()=>y,ip2long:()=>x,isCIDR:()=>q,isEqual:()=>z,isValidIP:()=>p,long2ip:()=>F,parseCIDR:()=>R});function x(t){if(!p(t))return!1;let r=[];t=y(t);let n=t.split(":");for(let e=0;e<n.length;e++){let s=parseInt(n[e],16);r.push(s.toString(2).padStart(16,"0"))}return BigInt(`0b${r.join("")}`)}function A(t){if(!p(t))return!1;if(x(t)===0n)return"::";t=y(t);let n=t.split(":").map(s=>{let f=parseInt(s,16);return f?f.toString(16):"X"}).join(":"),e=[/(X:X:X:X:X:X:X)/,/(X:X:X:X:X:X)/,/(X:X:X:X:X)/,/(X:X:X:X)/,/(X:X:X)/,/(X:X)/];for(let s=0;s<e.length;s++)if(n.match(e[s]))return n.replace(e[s],":").replace(":::","::").replaceAll("X","0");return n.replaceAll("X","0")}function F(t){if(typeof t!="bigint")return!1;if(t>=0n&&t<=340282366920938463463374607431768211455n){let r=[],n=t.toString(16).padStart(32,"0");for(let e=0;e<8;e++)r.push(n.slice(e*4,(e+1)*4));return A(r.join(":"))}else return!1}function q(t){return typeof t!="string"?!1:typeof R(t)=="object"}function z(t,r){return typeof t=="bigint"&&(t<0n||t>340282366920938463463374607431768211455n)||typeof r=="bigint"&&(r<0||r>340282366920938463463374607431768211455n)||(typeof t=="string"&&(t=x(t)),typeof r=="string"&&(r=x(r)),typeof t!="bigint"||typeof r!="bigint")?!1:t===r}function p(t){return/^[\s]*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)(\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)(\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)(\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)(\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)(\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)(\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)(\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}))|:)))(%.+)?[\s]*$/.test(t)}function R(t){if(typeof t!="string")return!1;let[r,n]=t.split("/");if(r===void 0||n===void 0)return!1;let e=+n;if(!p(r)||isNaN(e)||e<0||e>128)return!1;let s=BigInt(128-e),f=x(r),c=BigInt(0b1n<<s),I=f>>s<<s,w=F(I),v=F(I|c-1n);return{ipCount:c,firstHost:w,lastHost:v,prefixLength:e}}function y(t){if(!p(t))return!1;if(t==="::")return"0000:".repeat(8).slice(0,-1);let r=t.split(":");for(let e=0;e<r.length;e++)r[e]===""&&r[e+1]===""&&r.splice(e,1);let n=r[r.length-1];if(P.isValidIP(n)){let e=P.toBinHex(n).hex.slice(2);r.pop()&&r.push(e.slice(0,4),e.slice(4))}return r.map(e=>e?e.padStart(4,"0"):"0000:".repeat(9-r.length).slice(0,-1)).join(":")}function J(t){if(!i(t))return!1;let r=o(t),n=a(r);return{mapped:`::ffff:${n}`,comperssed:A(`::ffff:${n}`),expanded:y(`::ffff:${n}`)}}function h(t){if(typeof t!="number"||isNaN(t)||!u(t))return!1;let r=4294967295<<32-t;return t?a(r>>>0):"0.0.0.0"}function k(t){if(typeof t!="string"||!u(t))return!1;let r=o(t);return r===0?0:r.toString(2).replaceAll("0","").length}function K(t){if(!u(t))return!1;typeof t=="number"&&(t=h(t));let n=~o(t)>>>0;return a(n)}export{P as IPv4,H as IPv6};
